import{c as D,r as i,j as e,S as j,X as A,L as w,a as N,C as y,b as R,d as m,D as F,R as h,q as P,e as E,f as M,w as T,g as B,p as $,E as V}from"./index-Bjg852a1.js";const X=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],q=D("calculator",X),O=({isOpen:v,onClose:p})=>{const[o,k]=i.useState(""),[c,S]=i.useState(""),[d,n]=i.useState(null),[s,u]=i.useState(null),[x,b]=i.useState(!1),r=t=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(t||0);if(!v)return null;const z=async t=>{if(t.preventDefault(),!(!o.trim()||!c.trim())){n("loading"),u(null);try{const a=P(E(M,"enrollments"),T("referenceNumber","==",o.trim())),l=await B(a);if(l.empty)n("not-found");else{const g=l.docs[0].data();g.lastName?.toLowerCase()===c.trim().toLowerCase()?(u(g),n("found")):n("not-found")}}catch(a){console.error("Tracking Error:",a),n("error")}}},C=async()=>{if(s){b(!0);try{const t=await $(e.jsx(V,{data:s})).toBlob(),a=URL.createObjectURL(t),l=document.createElement("a");l.href=a,l.download=`${s.lastName}_EnrollmentForm.pdf`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}catch(t){console.error("Download Error:",t),alert("Failed to download PDF.")}finally{b(!1)}}},L=t=>{switch(t?.toLowerCase()){case"enrolled":return"text-emerald-600 bg-emerald-50 border-emerald-100";case"pending":return"text-amber-600 bg-amber-50 border-amber-100";case"rejected":return"text-red-600 bg-red-50 border-red-100";default:return"text-slate-600 bg-slate-50 border-slate-100"}},f=t=>t?Object.entries(t).map(([a,l])=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-100 last:border-0 border-dashed",children:[e.jsx("span",{className:"text-[10px] text-slate-500 font-medium uppercase tracking-wide truncate pr-2",children:a}),e.jsx("span",{className:"text-xs font-bold text-slate-700 whitespace-nowrap",children:r(l)})]},a)):null;return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-0 md:p-6 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity",onClick:p}),e.jsxs("div",{className:`relative bg-white md:rounded-[2rem] shadow-2xl transition-all duration-500 ease-in-out border border-white ring-1 ring-slate-100 overflow-hidden flex flex-col 
                ${s?"w-full h-full md:w-[95vw] md:h-[90vh] md:max-w-[1400px]":"w-full h-full md:h-auto md:w-full md:max-w-md md:max-h-[90vh]"}`,children:[e.jsxs("div",{className:"px-4 md:px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50 backdrop-blur-md shrink-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 shadow-sm",children:e.jsx(j,{size:16})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm md:text-base font-black text-slate-800 uppercase tracking-tight leading-tight",children:"Track Application"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest hidden md:block",children:"Real-time Enrollment Status"})]})]}),e.jsx("button",{onClick:p,className:"p-2 bg-white border border-slate-100 rounded-full transition text-slate-400 hover:text-red-500 hover:border-red-100 shadow-sm",children:e.jsx(A,{size:18})})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row overflow-hidden",children:[e.jsxs("div",{className:`bg-white transition-all duration-500 flex flex-col z-10 border-b md:border-b-0 md:border-r border-slate-100
                        ${s?"w-full md:w-[320px] lg:w-[360px] shrink-0 h-auto md:h-full overflow-y-auto custom-scrollbar p-4 md:p-6 bg-slate-50/30":"w-full p-6 md:p-8 h-full overflow-y-auto"}`,children:[e.jsxs("form",{onSubmit:z,className:`relative transition-all duration-500 ${s?"mb-6":"mb-8"}`,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1.5 block",children:"Reference Number"}),e.jsx("input",{type:"text",value:o,onChange:t=>k(t.target.value.toUpperCase()),placeholder:"SRCS-202X-XXXX",className:"w-full bg-white border border-slate-200 text-slate-900 font-bold text-sm rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-300 uppercase tracking-widest shadow-sm"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1.5 block flex items-center gap-1",children:["Last Name ",e.jsx(w,{size:10,className:"text-slate-300"})]}),e.jsx("input",{type:"text",value:c,onChange:t=>S(t.target.value),placeholder:"e.g. Santos",className:"w-full bg-white border border-slate-200 text-slate-900 font-bold text-sm rounded-xl py-3 px-4 focus:ring-2 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-300 shadow-sm"})]})]}),e.jsxs("button",{type:"submit",disabled:d==="loading"||!o||!c,className:"w-full mt-4 py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold text-xs uppercase tracking-wider flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-slate-200",children:[d==="loading"?e.jsx(N,{className:"animate-spin",size:16}):e.jsx(j,{size:16}),"Track Status"]})]}),!s&&e.jsx("div",{className:"text-center animate-fade-in mt-8",children:d==="not-found"?e.jsxs("div",{className:"py-6 px-4 bg-red-50 rounded-2xl border border-red-100",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 text-red-500 shadow-sm",children:e.jsx(y,{size:24})}),e.jsx("h4",{className:"text-slate-900 font-bold text-sm",children:"Record Not Found"}),e.jsx("p",{className:"text-[11px] text-slate-500 mt-2 leading-relaxed",children:"Please verify that your Reference Number and Last Name match our records exactly."})]}):e.jsxs("div",{className:"text-slate-400 py-4 opacity-60",children:[e.jsx(w,{size:32,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-xs font-medium",children:"Secure Verification Required"})]})}),d==="found"&&s&&e.jsxs("div",{className:"animate-fade-in-up space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-200 shadow-sm relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),e.jsxs("div",{className:"flex flex-col items-center text-center pt-2",children:[e.jsxs("div",{className:"w-16 h-16 bg-gradient-to-br from-indigo-500 to-fuchsia-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-indigo-100 text-2xl font-black mb-3",children:[s.firstName?.[0],s.lastName?.[0]]}),e.jsxs("h3",{className:"text-lg font-black text-slate-900 uppercase leading-tight mb-1",children:[s.firstName," ",s.lastName]}),e.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-4 bg-slate-50 px-2 py-1 rounded border border-slate-100",children:[s.gradeLevel," • ",s.studentType]}),e.jsxs("div",{className:`w-full py-2.5 px-3 rounded-xl border flex items-center justify-center gap-2 ${L(s.status)}`,children:[s.status==="Enrolled"?e.jsx(R,{size:16}):e.jsx(m,{size:16}),e.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:s.status||"Pending"})]})]})]}),e.jsxs("button",{onClick:C,disabled:x,className:"w-full py-3 bg-indigo-600 text-white rounded-xl font-bold text-xs uppercase tracking-wider flex items-center justify-center gap-2 hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-200 active:scale-95 disabled:opacity-70 group",children:[x?e.jsx(N,{className:"animate-spin",size:16}):e.jsx(F,{size:16,className:"group-hover:-translate-y-0.5 transition-transform"}),x?"Generating PDF...":"Download Registration Form"]})]})]}),d==="found"&&s&&e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-slate-50/50 p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 h-full",children:[e.jsx("div",{className:"lg:col-span-7 flex flex-col gap-5",children:s.status==="Enrolled"&&s.soa?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-black text-slate-800 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(q,{size:18,className:"text-indigo-600"}),"Statement of Accounts"]}),e.jsxs("span",{className:"text-[10px] font-bold bg-white border border-slate-200 px-3 py-1 rounded-full text-slate-500 shadow-sm",children:["SY ",s.schoolYear]})]}),e.jsx("div",{className:"bg-slate-900 rounded-2xl text-white p-1 shadow-xl shadow-slate-200 overflow-hidden",children:e.jsx("div",{className:"p-5 md:p-6 bg-gradient-to-br from-slate-900 to-slate-800",children:(()=>{const t=s.soa.subsidyAmount>0,a=t?s.soa.totalAssessment-s.soa.subsidyAmount:s.soa.totalAssessment,l=a/10;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 pb-4 border-b border-white/10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Total Assessment"}),e.jsx("span",{className:"text-lg md:text-xl font-bold text-white",children:r(s.soa.totalAssessment)})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1",children:"Less: Subsidy"}),e.jsx("span",{className:`text-lg md:text-xl font-bold ${t?"text-emerald-400":"text-slate-600"}`,children:t?`(${r(s.soa.subsidyAmount)})`:"—"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-300 uppercase tracking-wider",children:"Net Assessment"}),e.jsx("span",{className:"text-2xl md:text-3xl font-black text-white",children:r(a)})]}),e.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10 flex flex-col md:flex-row justify-between items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 shrink-0",children:e.jsx(h,{size:20})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-emerald-400 uppercase tracking-wider",children:"Outstanding Balance"}),e.jsx("span",{className:"text-lg font-black text-white",children:r(s.soa.balance)})]})]}),s.soa.balance>0&&e.jsxs("div",{className:"text-right w-full md:w-auto border-t md:border-t-0 md:border-l border-white/10 pt-3 md:pt-0 md:pl-4",children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase tracking-wider mb-0.5",children:"Monthly Installment"}),e.jsxs("p",{className:"text-base font-bold text-white",children:[r(l)," ",e.jsx("span",{className:"text-[10px] font-normal text-slate-500",children:"/mo"})]})]})]})]})})()})}),e.jsxs("div",{className:"space-y-3 animate-fade-in-up delay-75",children:[e.jsx("h5",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest pl-1",children:"Detailed Breakdown"}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1 bg-indigo-500 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-800 uppercase",children:"Tuition Fee"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Basic education fee"})]})]}),e.jsx("span",{className:"text-base font-black text-slate-800",children:r(s.soa.feeBreakdown?.tuition)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-400"}),e.jsx("p",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:"Standard Fees"})]}),e.jsx("div",{className:"space-y-0.5",children:f(s.soa.feeBreakdown?.standard)})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 pb-2 border-b border-slate-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-fuchsia-400"}),e.jsx("p",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:"Non-Standard Fees"})]}),e.jsx("div",{className:"space-y-0.5",children:f(s.soa.feeBreakdown?.nonStandard)})]})]})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-8 bg-white rounded-3xl border border-slate-200 text-center shadow-sm",children:[e.jsx("div",{className:"w-20 h-20 bg-amber-50 text-amber-500 rounded-full flex items-center justify-center mb-4 animate-pulse",children:e.jsx(m,{size:40})}),e.jsx("h4",{className:"text-lg font-black text-slate-800 uppercase mb-2",children:"Assessment Pending"}),e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium max-w-xs mx-auto",children:"Your Statement of Accounts (SOA) is currently being generated by the finance office. Please check back later."})]})}),e.jsx("div",{className:"lg:col-span-5 flex flex-col h-full",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 h-full flex flex-col shadow-sm sticky top-0 max-h-[500px] lg:max-h-none",children:[e.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-slate-100 pb-3",children:e.jsxs("h4",{className:"text-xs font-black text-slate-800 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(h,{size:14,className:"text-indigo-600"}),"Transaction History"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar pr-1",children:s.soa?.payments&&s.soa.payments.filter(t=>!t.isVoid).length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-emerald-50 text-emerald-800 rounded-xl p-4 border border-emerald-100 mb-4 flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest opacity-80",children:"Total Paid"}),e.jsx("span",{className:"text-xl font-black",children:r(s.soa.payments.reduce((t,a)=>t+(a.isVoid?0:a.amount),0))})]}),e.jsx("div",{className:"space-y-2",children:[...s.soa.payments].filter(t=>!t.isVoid).reverse().map((t,a)=>e.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-100 flex items-center justify-between hover:border-indigo-200 hover:shadow-sm transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-slate-50 border border-slate-100 flex items-center justify-center text-slate-400 group-hover:text-indigo-600 group-hover:bg-indigo-50 transition-colors",children:e.jsx(h,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-black text-slate-700 uppercase mb-0.5",children:t.mode}),e.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:new Date(t.date.seconds*1e3).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"block text-xs font-black text-emerald-600",children:["+",r(t.amount)]}),e.jsx("span",{className:"text-[9px] font-bold text-slate-300 uppercase",children:t.orNumber})]})]},a))})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center opacity-60 py-10",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center mb-3",children:e.jsx(m,{size:20,className:"text-slate-400"})}),e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"No transactions yet"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1 max-w-[150px]",children:"Payments will appear here once verified by the cashier."})]})}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-100 flex gap-2",children:[e.jsx(y,{size:14,className:"text-amber-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium leading-relaxed",children:"For payment discrepancies, please present your physical receipt to the finance office."})]})]})})]})})]})]})]})};export{O as default};
